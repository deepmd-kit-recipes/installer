{% set version = os.environ.get("VERSION") %}
{% set cuda_version = os.environ.get("CUDA_VERSION") %}
{% if cuda_version == '' %}
{% set variant = "cpu" %}
{% else %}
{% set variant = "cuda" + cuda_version + "_gpu" %}
{% endif %}

name: deepmd-kit
version: {{ version }}-{{ variant }}

channels:
- https://conda.anaconda.org/deepmodeling
- https://conda.deepmodeling.org  # [ppc64le]
- https://repo.anaconda.com/pkgs/main/
- https://conda.anaconda.org/conda-forge  # [ppc64le] 

specs:
- deepmd-kit {{ version }} *{{ variant }}
- libdeepmd {{ version }} *{{ variant }}
- lammps-dp
- horovod
{% if cuda_version == '' %}
- nocuda
{% endif %}
- dpdata

ignore_duplicate_files: True

license_file: ../LICENSE

company: DeepModeling

pre_install: pre_install.sh
post_install: post_install.sh
